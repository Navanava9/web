<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta content="IE=EDGE" http-equiv="X-UA-Compatible">
    <title>result</title>

    <link href="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script>

    <script src="../Lib/echarts.js"></script>
    <script src="../Lib/jquery-3.6.0.js"></script>
    <script src="../Lib/china.js"></script>
    <script src="../js/province_city_info.js"></script>

    <style>#china-map {
        width: 1000px;
        height: 1000px;
        margin: auto;
    }</style>
</head>
<body>
<div id="pie" style="width: 600px;height:400px;"></div>
<div id="zhi" style="width: 600px;height:400px;"></div>
<div id="china-map"></div>
</body>
</html>

<script>
    $(document).ready(function () {
        $.ajax({
            type: "get",
            url: "../GenderSummary.do",
            dataType: "json",
            success: function (response) {
                const pie = echarts.init(document.getElementById('pie'));

                const option = {
                    title: {
                        text: '性别比例',
                        left: 'center'
                    },
                    tooltip: {
                        trigger: 'item'
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'left'
                    },
                    series: [
                        {
                            name: 'Access From',
                            type: 'pie',
                            radius: '50%',
                            data: response,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                                }
                            }
                        }
                    ]
                };

                pie.setOption(option);
            }
        });
    });

    $(document).ready(function () {
        $.ajax({
            type: "get",
            url: "../ProvinceSummary.do",
            dataType: "json",
            success: function (response) {
                const zhi = echarts.init(document.getElementById('zhi'));

                const provinceName = [];
                const provinceAmount = [];

                for (let i = 0; i < response.length; i++) {
                    provinceName.push(response[i].name);
                    provinceAmount.push(response[i].value);
                }

                const option = {
                    xAxis: {
                        type: 'category',
                        data: provinceName
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [
                        {
                            data: provinceAmount,
                            type: 'bar'
                        }
                    ]
                };
                zhi.setOption(option);
            }
        });
    });

    $(document).ready(function () {
        $.ajax({
            type: "get",
            url: "../ProvinceSummary.do",
            dataType: "json",
            success: function (response) {
                var date = SwitchSimpleProvinceName(response);
                const CMap = echarts.init(document.getElementById('china-map'));
                const option = {
                    title: {
                        text: '人数分布',
                        subtext: '学习用途(虚构)',
                        x: 'center'
                    },
                    tooltip: {
                        trigger: 'item'
                    },
                    legend: {
                        orient: 'horizontal',
                        x: 'left',
                        data: ['人数']
                    },

                    visualMap: {
                        x: 'left',
                        y: 'center',
                        min: 0,
                        max: 12,
                        calculable: true,
                        text: ['高', '低'],
                        color: ['#005196', '#008dff', '#bebebe']
                    },
                    toolbox: {
                        show: true,
                        orient: 'vertical',
                        x: 'right',
                        y: 'center',
                        feature: {
                            mark: {show: true},
                            dataView: {show: true, readOnly: false},
                            restore: {show: true},
                            saveAsImage: {show: true}
                        }
                    },
                    roamController: {
                        show: true,
                        x: 'right',
                        mapTypeControl: {
                            'china': true
                        }
                    },
                    series: [
                        {
                            name: '人数',
                            type: 'map',
                            mapType: 'china',
                            roam: false,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: true,
                                        textStyle: {
                                            color: "rgb(249,249,249)"
                                        }
                                    }
                                },
                                emphasis: {
                                    label: {show: true},
                                }
                            },
                            top: "3%",
                            data: date
                        }
                    ]
                };
                CMap.setOption(option);
            }
        });
    });
</script>